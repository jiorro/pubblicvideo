<!doctype html>
<html lang="it">
<head>
  <!-- =========================================================
       META BASE
       ========================================================= -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jiorro Video Manager</title>
  <meta name="color-scheme" content="dark" />
  <meta name="theme-color" content="#0a0a0b" />

  <!-- =========================================================
       RESET GRAFICA + THEME DARK
       ========================================================= -->
  <style>
    :root {
      --bg:#0a0a0b;
      --panel:#141519;
      --panel-2:#18191d;
      --text:#e9e9ed;
      --muted:#9aa0ab;
      --border:#2a2f38;
      --accent:#00ff88;   /* verde fosforescente */
      --danger:#ff6b6b;
      --brand:#6fa8ff;
    }
    body {
      margin:0; background:var(--bg); color:var(--text);
      font-family:system-ui,sans-serif;
    }
    * { box-sizing:border-box; }

    /* TOPBAR */
    .topbar {
      position:fixed; top:0; left:0; right:0; height:64px;
      display:flex; justify-content:space-between; align-items:center;
      padding:0 18px; background:#111; border-bottom:1px solid var(--border);
      z-index:1000;
    }
    .lens-btn {
      width:44px; height:44px; border-radius:12px;
      background:var(--panel); border:1px solid var(--border);
      color:var(--accent); font-size:20px; cursor:pointer;
    }

    /* STATUS */
    .status { position:fixed; top:70px; right:20px; font-size:13px; color:var(--muted); z-index:950; }
    .status.success{color:var(--accent)} .status.error{color:var(--danger)}

    /* SECTIONS */
    .section { padding-top:96px; min-height:100vh; }
    .hidden { display:none; }
    .panel { background:var(--panel); border:1px solid var(--border); border-radius:12px; padding:20px; }

    /* HOME */
    .pill { display:inline-block; padding:4px 8px; border-radius:999px; background:#202025; color:var(--muted); border:1px solid var(--border); font-size:13px; margin:2px; }
    .pill-list { display:flex; flex-wrap:wrap; }

    /* VIDEO CARDS */
    .cards { display:grid; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); gap:14px; margin-top:12px; }
    .card { background:var(--panel); border:1px solid var(--border); padding:10px; border-radius:12px; }
    .card video {
      width:100%; border-radius:8px; background:black;
      border:2px solid var(--accent); box-shadow:0 0 12px var(--accent);
    }
    .title { font-weight:600; }
    .views { color:var(--muted); font-size:13px; }

    /* ADMIN TABLE */
    table.admin-grid { width:100%; border-collapse:collapse; margin-top:12px; }
    table.admin-grid th, table.admin-grid td { padding:10px; border-top:1px solid var(--border); }

    /* MODAL UPLOAD */
    .modal { position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.55); }
    .modal.show { display:flex; }
    .modal-panel { width:92%; max-width:680px; background:var(--panel); border:1px solid var(--border); padding:18px; border-radius:12px; }
    .progress { height:8px; border-radius:999px; background:#111; margin-top:8px; overflow:hidden; }
    .progress > i { display:block; height:100%; width:0; background:linear-gradient(90deg,var(--brand),var(--accent)); }

    /* ADMIN ANCHOR */
    .admin-anchor { position:fixed; left:12px; bottom:12px; display:flex; flex-direction:column; gap:8px; }
    .admin-btn { width:44px; height:44px; border-radius:999px; background:var(--panel); border:1px solid var(--border); display:flex; align-items:center; justify-content:center; color:var(--accent); font-size:18px; cursor:pointer; }
    .admin-input { width:220px; padding:8px; border-radius:10px; border:1px solid var(--border); background:var(--panel); color:var(--text); }
  </style>
</head>
<body>
  <!-- NAVBAR -->
  <header class="topbar">
    <div>Jiorro Video Manager</div>
    <button id="lensBtn" class="lens-btn">üîç</button>
  </header>

  <!-- STATUS -->
  <div id="statusEl" class="status"></div>

  <!-- HOME -->
  <main id="homeSection" class="section">
    <div class="panel">
      <h1>La regione di Canaan</h1>
      <p>Importa, cerca, riproduci e gestisci i tuoi video. Admin completo, upload con progress e tracking views.</p>
      <ul class="pill-list">
        <li class="pill">Import automatico</li>
        <li class="pill">Ricerca client</li>
        <li class="pill">Upload con progress</li>
        <li class="pill">Admin completo</li>
      </ul>
    </div>
  </main>

  <!-- VIDEO -->
  <section id="videoSection" class="section hidden">
    <div class="panel">
      <button id="backHome">üè† Home</button>
      <button id="openUpload">‚¨ÜÔ∏è Carica</button>
      <input id="searchVideos" placeholder="Cerca video" />
      <div id="videoContainer" class="cards"></div>
    </div>
  </section>

  <!-- ADMIN -->
  <section id="adminSection" class="section hidden">
    <div class="panel">
      <h2>üîß Admin</h2>
      <table class="admin-grid">
        <thead><tr><th>Anteprima</th><th>Titolo</th><th>Views</th><th>Stato</th><th>Azioni</th></tr></thead>
        <tbody id="adminBody"></tbody>
      </table>
    </div>
  </section>

  <!-- UPLOAD MODAL -->
  <div id="uploadModal" class="modal">
    <div class="modal-panel">
      <h3>Carica Video</h3>
      <input id="videoFile" type="file" accept="video/*" />
      <input id="videoTitle" placeholder="Titolo (opzionale)" />
      <input id="overlaySrc" placeholder="Overlay source (opzionale)" />
      <div class="progress"><i id="uploadProgress"></i></div>
      <button id="uploadBtn">Carica</button>
      <button id="closeUpload">Chiudi</button>
      <div id="uploadStatus"></div>
    </div>
  </div>

  <!-- ADMIN ANCHOR -->
  <div class="admin-anchor">
    <button id="adminAnchorBtn" class="admin-btn">üîë</button>
    <div id="adminInputWrap" style="display:none">
      <input id="adminInput" class="admin-input" placeholder="Password admin" />
      <button id="adminSubmit">Sblocca</button>
      <button id="adminToHome">Home</button>
      <button id="adminToVideo">Video</button>
    </div>
  </div>

  <!-- SCRIPT -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const STORAGE_KEY = 'jiorroVideos_secure_v1';
      const ADMIN_PASS = 'JIORR0CON$=LE';
      const LINK_J_DEFAULT = "https://it.wikipedia.org/wiki/Antonio_D%27Agostino";

      function getSaved(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY))||[] }catch(e){ return [] } }
      function setSaved(arr){ localStorage.setItem(STORAGE_KEY, JSON.stringify(arr||[])) }
      function showStatus(msg,type){ const s=document.getElementById('statusEl'); s.textContent=msg||''; s.className
