<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jiorro Video Manager</title>
  <!-- Collego il CSS esterno -->
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Navbar -->
  <header class="topbar">
    <div>Jiorro Video Manager</div>
    <button id="lensBtn" class="lens-btn">ğŸ”</button>
  </header>

  <!-- Status -->
  <div id="statusEl" class="status"></div>

  <!-- Home -->
  <main id="homeSection" class="section">
    <div class="panel">
      <h1>La regione di Canaan</h1>
      <p>Importa, cerca, riproduci e gestisci i tuoi video. Admin completo, upload con progress e tracking views.</p>
      <ul class="pill-list">
        <li class="pill">Import automatico</li>
        <li class="pill">Ricerca client</li>
        <li class="pill">Upload con progress</li>
        <li class="pill">Admin completo</li>
      </ul>
    </div>
  </main>

  <!-- Video -->
  <section id="videoSection" class="section hidden">
    <div class="panel">
      <button id="backHome">ğŸ  Home</button>
      <button id="openUpload">â¬†ï¸ Carica</button>
      <input id="searchVideos" placeholder="Cerca video" />
      <div id="videoContainer" class="cards"></div>
    </div>
  </section>

  <!-- Admin -->
  <section id="adminSection" class="section hidden">
    <div class="panel">
      <h2>ğŸ”§ Admin</h2>
      <table class="admin-grid">
        <thead><tr><th>Anteprima</th><th>Titolo</th><th>Views</th><th>Stato</th><th>Azioni</th></tr></thead>
        <tbody id="adminBody"></tbody>
      </table>
    </div>
  </section>

  <!-- Upload Modal -->
  <div id="uploadModal" class="modal">
    <div class="modal-panel">
      <h3>Carica Video</h3>
      <input id="videoFile" type="file" accept="video/*" />
      <input id="videoTitle" placeholder="Titolo (opzionale)" />
      <input id="overlaySrc" placeholder="Overlay source (opzionale)" />
      <div class="progress"><i id="uploadProgress"></i></div>
      <button id="uploadBtn">Carica</button>
      <button id="closeUpload">Chiudi</button>
      <div id="uploadStatus"></div>
    </div>
  </div>

  <!-- Admin Anchor -->
  <div class="admin-anchor">
    <button id="adminAnchorBtn" class="admin-btn">ğŸ”‘</button>
    <div id="adminInputWrap" style="display:none">
      <input id="adminInput" class="admin-input" placeholder="Password admin" />
      <button id="adminSubmit">Sblocca</button>
      <button id="adminToHome">Home</button>
      <button id="adminToVideo">Video</button>
    </div>
  </div>

  <!-- Script -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const homeSection=document.getElementById('homeSection');
      const videoSection=document.getElementById('videoSection');
      const adminSection=document.getElementById('adminSection');
      const lensBtn=document.getElementById('lensBtn');
      const backHome=document.getElementById('backHome');
      const openUploadBtn=document.getElementById('openUpload');
      const uploadModal=document.getElementById('uploadModal');
      const closeUploadBtn=document.getElementById('closeUpload');
      const uploadBtn=document.getElementById('uploadBtn');
      const adminAnchorBtn=document.getElementById('adminAnchorBtn');
      const adminInputWrap=document.getElementById('adminInputWrap');
      const adminInput=document.getElementById('adminInput');
      const adminSubmit=document.getElementById('adminSubmit');

      // Navigazione sezioni
      lensBtn.addEventListener('click', () => {
        homeSection.classList.add('hidden');
        videoSection.classList.remove('hidden');
        adminSection.classList.add('hidden');
      });
      backHome.addEventListener('click', () => {
        homeSection.classList.remove('hidden');
        videoSection.classList.add('hidden');
        adminSection.classList.add('hidden');
      });

      // Upload modal
      openUploadBtn.addEventListener('click', () => uploadModal.classList.add('show'));
      closeUploadBtn.addEventListener('click', () => uploadModal.classList.remove('show'));
      uploadBtn.addEventListener('click', handleUpload);
          formData.append("upload_preset", "jiorro_upload"); 
          const cloudName = "dng8rjd6u";


      // Admin unlock
      adminAnchorBtn.addEventListener('click', () => {
        adminInputWrap.style.display = adminInputWrap.style.display === 'flex' ? 'none' : 'flex';
      });
      adminSubmit.addEventListener('click', () => {
        if (adminInput.value === 'JIORR0CON$=LE') {
          homeSection.classList.add('hidden');
          videoSection.classList.add('hidden');
          adminSection.classList.remove('hidden');
        } else {
          alert("Password errata");
        }
      });

      // Tasto J â†’ Wikipedia
      window.addEventListener('keyup', (e) => {
        if (e.key.toLowerCase() === 'j') {
          window.open("https://it.wikipedia.org/wiki/Antonio_D%27Agostino", "_blank");
        }
      });
    });
  </script>
</body>
</html>
